'use strict';

import React, { Component } from 'react';
import { View, Text, ListView, Button, Image } from 'react-native';
import { MaterialIcons } from '@expo/vector-icons';
import Colors from '../../../constants/Colors';
import styles from './styles/ContactsScreen';
import { Contacts } from 'expo';

import {
  Card,
  CardImage,
  CardTitle,
  CardContent,
  CardAction
} from 'react-native-card-view';

const ds = new ListView.DataSource({rowHasChanged: (r1, r2) => r1 !== r2});

class ContactsScreen extends Component {
  static navigationOptions = {
    header: {
      style: {
        backgroundColor: Colors.whiteColor
      }
    },
    
    tabBar: {
      icon: ({ tintColor }) => (
        <MaterialIcons 
          name="contacts"
          size={25}
          color={tintColor}
        />
      )
    }
  }

  constructor() {
    super();
    
    this.state = {
      dataSource: ds.cloneWithRows([]),
    };
  }

  componentDidMount() {
    this.getAllContacts();
  }

  async getAllContacts() {
    const contacts = await Contacts.getContactsAsync([
      Contacts.PHONE_NUMBERS,
      Contacts.EMAILS
    ]);
    if (contacts.length > 0) {
      this.setState({dataSource: ds.cloneWithRows(contacts)})
    }
  }

  render() {
    return (
      <ListView
        dataSource={this.state.dataSource}
        renderRow={(rowData) => <View>
          <Card>
            <CardImage>
              <Image
                style={{width: 300, height: 150}}
                source={{uri: 'https://getmdl.io/assets/demos/image_card.jpg'}}
              />
            </CardImage>
            <CardContent>
              <Text style={styles.title}>{rowData.name}</Text>
              <Text>{rowData.email}</Text>
              <Text>here</Text>
            </CardContent>
            <CardAction>
              <Button
                style={styles.button}
                onPress={() => {}}
                title='Select'>
              </Button>
            </CardAction>
          </Card>
        </View>
        }
        enableEmptySections={true}
      />
    );
  }
}

export default ContactsScreen;